import type { NextApiRequest, NextApiResponse } from 'next'; import { getHandEvents, appendEvent } from '@/lib/rooms'; export default async function h(req:NextApiRequest,res:NextApiResponse){ const roomId=(req.query.roomId as string)||(req.body?.roomId as string); const handNo=parseInt((req.query.hand as string)||(req.body?.hand as string)||'0',10); if(!roomId) return res.status(400).json({error:'roomId required'}); if(req.method==='GET'){ const evs=await getHandEvents(roomId,handNo); return res.json({events:evs}); } if(req.method==='POST'){ const ev=req.body?.event||{}; await appendEvent(roomId,handNo,ev); return res.json({ok:true}); } return res.status(405).json({error:'Method Not Allowed'}); }